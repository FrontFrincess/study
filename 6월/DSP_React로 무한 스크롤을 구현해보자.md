![](https://velog.velcdn.com/images/somda/post/5153016e-42fd-45b7-911a-1b83dae495ec/image.gif)

ê°•ì•„ì§€ë¥¼ ë¬´í•œëŒ€ë¡œ ì¦ê¸¸ ìˆ˜ ìˆê²Œ ë¬´í•œ ìŠ¤í¬ë¡¤ì„ êµ¬í˜„í•´ë³´ì.

## 1. í˜ì´ì§€ë„¤ì´ì…˜ê³¼ ë¬´í•œìŠ¤í¬ë¡¤
 í˜ì´ì§€ë„¤ì´ì…˜ìœ¼ë¡œ 2í˜ì´ì§€, 3í˜ì´ì§€ ì´ë ‡ê²Œ ë„˜ì–´ê°ˆ ìˆ˜ ìˆìŒì—ë„ êµ³ì´ ë¬´í•œ ìŠ¤í¬ë¡¤ì„ ì“°ëŠ” ì´ìœ ëŠ” ë­˜ê¹Œ? í´ë¦­ í•˜ë‚˜ë„ ê²°êµ­ ìˆ˜ê³ ë¡œì›€ì´ê¸°ì— ê·¸ëŸ° ê²ƒë“¤ì„ ì¤„ì´ê¸° ìœ„í•œ ê³ ë¯¼ìœ¼ë¡œ ë‚˜ì˜¤ì§€ ì•Šì•˜ì„ê¹Œ ì‹¶ë‹¤. 
 ë¬¼ë¡  ëª¨ë“  ì›¹ì‚¬ì´íŠ¸ì—ì„œ ë¬´í•œ ìŠ¤í¬ë¡¤ì´ ìœ ì € ê²½í—˜ì— ë‚«ë‹¤ëŠ” ê±¸ ë§í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.

 ì˜ˆë¥¼ ë“¤ì–´ ì¸ìŠ¤íƒ€ê·¸ë¨ í”¼ë“œì™€ ê°™ì€ SNSëŠ” í›‘ìœ¼ë©° ì§€ë‚˜ê°€ëŠ”, êµ¬ê²½í•˜ëŠ” ì„œë¹„ìŠ¤ì´ê¸°ì— ë¬´í•œ ìŠ¤í¬ë¡¤ì´ ì í•©í•  ê²ƒì´ê³  ë¬´ì‹ ì‚¬ì™€ ê°™ì€ ì‡¼í•‘ëª°ì€ ìƒí’ˆì˜ ìœ„ì¹˜ë¥¼ ê¸°ì–µí•˜ê³  ì–¸ì œë“  ë‹¤ì‹œ ê·¸ ìƒí’ˆì„ ëˆŒëŸ¬ë³´ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ê¸° ë•Œë¬¸ì— í˜ì´ì§€ë„¤ì´ì…˜ì´ ì í•©í•  ê²ƒì´ë‹¤.

 ê·¸ë ‡ë‹¤ë©´ ê²°êµ­ ì ì¬ì ì†Œì— í™œìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ë‘˜ ë‹¤ ì•Œì•„ì•¼í•˜ì§€ ì•Šê² ëŠ”ê°€ ğŸ˜


## 2. ë¬´í•œ ìŠ¤í¬ë¡¤, ì–´ë–»ê²Œ êµ¬í˜„í• ê¹Œ?

### Scroll Event
ì²˜ìŒì—ëŠ” scroll ì´ë²¤íŠ¸ë¥¼ ê°ì§€í•˜ë‹¤ê°€, í˜ì´ì§€ ê°€ì¥ ì•„ë˜ì— ë‹¿ì•˜ì„ ë•Œ ì¯¤ API ìš”ì²­ì„ í•˜ë©´ ë˜ì§€ ì•Šì„ê¹Œ? ì‹¶ì—ˆë‹¤.
í•˜ì§€ë§Œ ì´ë ‡ê²Œ êµ¬í˜„í•˜ê²Œ ë˜ë©´ scroll ì´ë²¤íŠ¸ë¥¼ ê³„~ì† ê°ì§€í•´ì•¼í•˜ê¸° ë•Œë¬¸ì— ì„±ëŠ¥ ì €í•˜ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆëŠ” ë¬¸ì œê°€ ìˆë‹¤.

ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ `debounce`ë‚˜ `throttle`ë¥¼ ì ìš©í•´ ì¼ë¶€ ì„±ëŠ¥ì„ ê°œì„ í•  ìˆ˜ ìˆë‹¤. ë‘ê°€ì§€ ëª¨ë‘ ì‹œê°„ì˜ í…€ì„ ë‘ì–´ ì¡°ê¸ˆì´ë‚˜ë§ˆ ì´ë²¤íŠ¸ ê°ì§€ íšŸìˆ˜ë¥¼ ì¤„ì¼ ìˆ˜ ìˆê²Œ í•œë‹¤. 
ë‘ ê°€ì§€ ëª¨ë‘ ì„±ëŠ¥ ê°œì„ ì— ê·¸ë˜ë„ ê½¤ ë„ì›€ì„ ì£¼ëŠ” ë°©ë²•ë“¤ì´ë¼ ì¶”í›„ì— ì •ë¦¬í•˜ê¸°ë¡œ í•˜ê³ ... 

### Intersection Observer API
ìš°ì„ ì€ Intersection Observer APIë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ íƒí•˜ê¸°ë¡œ í•œë‹¤.

> Intersection Observer APIëŠ” íƒ€ê²Ÿ ìš”ì†Œì™€ ìƒìœ„ ìš”ì†Œ ë˜ëŠ” ìµœìƒìœ„ document ì˜ viewport ì‚¬ì´ì˜ intersection ë‚´ì˜ ë³€í™”ë¥¼ ë¹„ë™ê¸°ì ìœ¼ë¡œ ê´€ì°°í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤. (ì¶œì²˜: MDN)

í•´ë‹¹ APIë¥¼ í†µí•´ ìŠ¤í¬ë¡¤ì„ ë‚´ë¦¬ë‹¤ê°€ íƒ€ê²Ÿì´ viewportì— ë“¤ì–´ì˜¤ë©´ ë°ì´í„°ë¥¼ í˜¸ì¶œí•˜ëŠ” ì‹ìœ¼ë¡œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.


## 4. ê·¸ëŸ¼ êµ¬í˜„í•´ë³´ì!

### ì–´ë–¤ ê±¸ë¡œ?
ê·€ì—¬ìš´ ê°•ì•„ì§€ë“¤ì„ ë¬´í•œëŒ€ë¡œ ì¦ê²¨ë³¼ê¹Œ ì‹¶ì–´ dogAPIë¥¼ í™œìš©í–ˆë‹¤. ğŸ¶
dogAPI ì‚¬ìš©ë²•ì€ [ì´ê³³](https://documenter.getpostman.com/view/5578104/2s935hRnak)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

ìš°ì„  dogAPIë¥¼ ì‚¬ìš©í•´ë³´ì.
paramsë„ API URLì— í•œêº¼ë²ˆì— ë„£ì–´ì„œ ëƒ…ë‹¤ ìš”ì²­ì„ ë³´ë‚´ë³¸ë‹¤.
```typescript
  useEffect(() => {
    console.log("ë¡œë“œ");

    const API_URL =
      "https://api.thedogapi.com/v1/images/search?size=small&format=json&has_breeds=true&order=ASC&page=0&limit=10";
    axios.get(API_URL).then((res) => {
      console.log(res);
    });
  }, []);

  return (
    <div className="dog-imgs-container">
      <p>cute</p>
    </div>
  );
}
```

ë°ì´í„°ëŠ” ì´ë ‡ê²Œ id, urlì •ë³´ì™€ ì›ë³¸ ì´ë¯¸ì§€ì˜ widthì™€ height ì •ë³´ê¹Œì§€ ë°˜í™˜í•´ì¤€ë‹¤.
![](https://velog.velcdn.com/images/somda/post/4be9a46a-4d16-4cbb-a4f1-70872ca00b0c/image.png)


ê·¸ëŸ¼ ë¹¨ë¦¬ ê·€ì—¬ìš´ ê°•ì•„ì§€ë¥¼ ë´ë³´ì.
```ts
import React, { useEffect, useState } from "react";
import axios from "axios";

interface dogImgInterface {
  id: string;
  dogUrl: string;
}

export default function Dogs() {
  const [dogImgArr, setDogImgArr] = useState<dogImgInterface[]>([]);

  useEffect(() => {
    console.log("ë¡œë“œ");

    // keyê°€ ì—†ìœ¼ë©´ ì‘ë‹µì€ 10ê°œì”©
    const API_URL =
      "https://api.thedogapi.com/v1/images/search?size=small&format=json&has_breeds=true&order=ASC&page=0&limit=10";
    axios.get(API_URL).then((res) => {
      console.log(res);
      
      // idê°’ê³¼ urlë§Œ ì €ì¥
      const gotData = res.data.map((dogImg: { id: string; url: string }) => ({
        id: dogImg.id,
        dogUrl: dogImg.url,
      }));
      setDogImgArr(gotData);
    });
  }, []);

  return (
    <div className="dog-imgs-container">
      {dogImgArr &&
        dogImgArr.map((dogImg: dogImgInterface) => (
          <div key={dogImg.id} className="dog-img-card">
            <img src={dogImg.dogUrl} />
            <p>cute_{dogImg.id}</p>
          </div>
        ))}
    </div>
  );
}
```

![](https://velog.velcdn.com/images/somda/post/c8ef7a1e-3db3-422b-8c57-dca91e352735/image.png)
ì•„ì£¼ ì˜ ë¶ˆëŸ¬ì™€ì§„ë‹¤!

### ì´ì œ ë¬´í•œ ìŠ¤í¬ë¡¤ì„ ì ìš©í•´ë³´ì!

1. ìš°ì„  ê´€ì°° ëŒ€ìƒì´ ë  ëŒ€ìƒì„ í•˜ë‚˜ ë§Œë“¤ê³ , í˜ì´ì§•ì„ ì¤€ë¹„í•œë‹¤.
```ts
    <div className="dog-imgs-container">
      {dogImgArr &&
        dogImgArr.map((dogImg: dogImgInterface) => (
          <div key={dogImg.id} className="dog-img-card">
            <img src={dogImg.dogUrl} />
            <p>cute_{dogImg.id}</p>
          </div>
        ))}
      {isLoading && <p>Loading...</p>}
      <div id="observer" style={{ height: "10px" }}></div>
    </div>
```
í˜ì´ì§€ ìµœí•˜ë‹¨ì— idê°€ observerì¸ ë¹ˆ divë¥¼ í•˜ë‚˜ ë§Œë“¤ì—ˆë‹¤.
Loadingë„ í‘œì‹œí•´ë´¤ë‹¤.

```ts
  const [page, setPage] = useState(0);
  const [isLoading, setIsLoading] = useState(false);
  const [dogImgArr, setDogImgArr] = useState<dogImgInterface[]>([]);
```
ë¬´í•œìŠ¤í¬ë¡¤ë„ ë”°ì§€ê³  ë³´ë©´ ì¼ì¢…ì˜ í˜ì´ì§€ë„¤ì´ì…˜ì´ê¸° ë•Œë¬¸ì— í˜ì´ì§€ ì •ë³´ì™€, ë¡œë”© ì •ë³´ë„ useStateë¥¼ í™œìš©í•´ ì¶”ê°€ë¡œ ë‹´ì•„ì¤€ë‹¤.

2. Intersection Observer APIë¥¼ ì‚¬ìš©í•´ë³´ì!

ì¸ìŠ¤í„´ìŠ¤ëŠ”
`const observer![](https://velog.velcdn.com/images/somda/post/7f8adfaf-2592-46dd-9242-c23e534c5725/image.gif)
 = new IntersectionObserver(callback, options);`
ì´ì™€ ê°™ì´ ìƒì„±í•  ìˆ˜ ìˆë‹¤.
`callback` , `options` 2ê°œì˜ íŒŒë¼ë¯¸í„°ë¥¼ ë°›ëŠ”ë°

ë‚˜ëŠ” callbackí•¨ìˆ˜ë¡œ handleObserverë¥¼ ë§Œë“¤ê³ , ì˜µì…˜ì€ ë°”ë¡œ ì‘ì„±í–ˆë‹¤.
(callback í•¨ìˆ˜ëŠ” íŒŒë¼ë¯¸í„°ë¡œ `entries`ì™€ `observer` ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤.)

```ts
  // Intersection Observer ì„¤ì •

  const handleObserver = (entries: IntersectionObserverEntry[]) => {
    const target = entries[0];
    if (target.isIntersecting && !isLoading) {
      setPage((prevPage) => prevPage + 1);
    }
  };
  /*
  handleObserver: êµì°¨ì ì´ ë°œìƒí–ˆì„ ë•Œ ì‹¤í–‰ë˜ëŠ” ì½œë°± í•¨ìˆ˜.
  entries: êµì°¨ì  ì •ë³´ë¥¼ ë‹´ëŠ” ë°°ì—´
  isIntersecting: êµì°¨ì (intersection)ì´ ë°œìƒí•œ ìš”ì†Œì˜ ìƒíƒœ
  êµì°¨ì ì´ ë°œìƒí•˜ë©´ page 1 ì¦ê°€
  */

  useEffect(() => {
    const observer = new IntersectionObserver(handleObserver, {
      threshold: 0, //  Intersection Observerì˜ ì˜µì…˜, 0ì¼ ë•ŒëŠ” êµì°¨ì ì´ í•œ ë²ˆë§Œ ë°œìƒí•´ë„ ì‹¤í–‰, 1ì€ ëª¨ë“  ì˜ì—­ì´ êµì°¨í•´ì•¼ ì½œë°± í•¨ìˆ˜ê°€ ì‹¤í–‰.
    });
    // ìµœí•˜ë‹¨ ìš”ì†Œë¥¼ ê´€ì°° ëŒ€ìƒìœ¼ë¡œ ì§€ì •í•¨
    const observerTarget = document.getElementById("observer");
    // ê´€ì°° ì‹œì‘
    if (observerTarget) {
      observer.observe(observerTarget);
    }
  }, []);
```

â€» ì°¸ê³ : entriesê°€ ë‹´ê³  ìˆëŠ” ì •ë³´ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
  ![](https://velog.velcdn.com/images/somda/post/30909702-7dca-4bb3-990a-68f6795620ea/image.png)


ìœ„ì—ì„œ ìµœí•˜ë‹¨ì— ì§€ì •í–ˆë˜ ê´€ì°°ëŒ€ìƒì„ ë§Œë‚˜ë©´ í˜ì´ì§€ê°€ 1 ì¶”ê°€ë˜ê²Œ í–ˆë‹¤.

3. ê·¸ëŸ¼ ì´ì œ í˜ì´ì§€ê°€ ì¶”ê°€ë¨ì— ë”°ë¼ APIë¥¼ í˜¸ì¶œí•´ë³´ì!

```ts
  // page ë³€ê²½ ê°ì§€ì— ë”°ë¥¸ APIí˜¸ì¶œ
  useEffect(() => {
    fetchData();
    // console.log(page);
  }, [page]);

  // APIë¥¼ í˜¸ì¶œí•˜ëŠ” ë¶€ë¶„
  const fetchData = async () => {
    setIsLoading(true);
    try {
      const API_URL = `https://api.thedogapi.com/v1/images/search?size=small&format=json&has_breeds=true&order=ASC&page=${page}&limit=10`;
      const response = await axios.get(API_URL);
      const newData = response.data.map(
        (dogImg: { id: string; url: string }) => ({
          id: dogImg.id,
          dogUrl: dogImg.url,
        })
      );
      // ë¶ˆëŸ¬ì˜¨ ë°ì´í„°ë¥¼ ë°°ì—´ì— ì¶”ê°€
      setDogImgArr((prevData) => [...prevData, ...newData]);
    } catch (error) {
      console.log(error);
    }
    setIsLoading(false);
  };
```

4. ì™„ì„±!

![](https://velog.velcdn.com/images/somda/post/0b9480f9-e996-4631-a0d3-0c5e3b9fa350/image.gif)

ìŠ¥ì‚­ìŠ¥ì‚­ ì˜ ë„˜ì–´ê°„ë‹¤ :)


### ê°œì„ í•´ë³¸ë‹¤ë©´?
 í˜„ì¬ ì½”ë“œëŠ” íƒ€ê²Ÿì´ í˜ì´ì§€ ìµœí•˜ë‹¨ì— ìœ„ì¹˜í•´ìˆì–´ ìŠ¤í¬ë¡¤ì´ ìµœí•˜ë‹¨ì— ë„ë‹¬í•´ì•¼ APIë¥¼ í˜¸ì¶œí•˜ê¸° ë•Œë¬¸ì— ì¸í„°ë„· ì†ë„ì— ë”°ë¼ ë¡œë”©ì´ ê¸¸ì–´ì§€ê¸°ë„ í•œë‹¤.
 useRefë¥¼ í™œìš©í•´ ë°°ì—´ì˜ ì ˆë°˜ ì •ë„ ì¯¤ì— targetì„ ì„¤ì •í•˜ì—¬ ì¡°ê¸ˆ ë” ë¯¸ë¦¬ APIë¥¼ í˜¸ì¶œí•˜ëŠ” ë°©ì‹ë„ ì¡´ì¬í•  ê²ƒì´ë‹¤. ë‹¤ë§Œ ì´ë ‡ê²Œ í•˜ë©´ ë¶ˆí•„ìš”í•œ ì‹œì ì— APIë¥¼ í˜¸ì¶œí•˜ê²Œ ë  ìˆ˜ë„ ìˆì–´ ì´ê²ƒë„ ì–´ë””ê¹Œì§€ë‚˜ ìƒí™©ì— ë§ê²Œ ì ìš©í•˜ë©´ ë  ê²ƒ ê°™ë‹¤. :)

 ì´ì „ì— í”„ë¡œì íŠ¸ë¥¼ í•˜ë©´ì„œ ë¬´í•œìŠ¤í¬ë¡¤ì„ ì ìš©í•´ë³´ì§€ ëª»í•´ ì•„ì‰¬ì› ëŠ”ë° ì´ë ‡ê²Œë‚˜ë§ˆ ì ìš©í•´ë³´ë‹ˆ ì°¸ ì¢‹ë‹¤~ ğŸ˜